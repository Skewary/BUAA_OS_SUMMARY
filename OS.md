# 引论

# 内存管理

## 存储器管理

### 存储管理基础

#### • **存储器硬件发展**	

§ **静态存储器（SRAM）：读写速度快，生产成本高，多用** 

**于容量较小的高速缓冲存储器。- 用于做Cache**	 

§ **动态存储器（DRAM）：读写速度较慢，集成度高，生产** 

**成本低，多用于容量较大的主存储器。**	

![1560006914028](C:\Users\叶志翔\Desktop\OS小结\assets\1560006914028.png)

![1560006978648](assets/1560006978648.png)

![1560006996741](assets/1560006996741.png)

#### • **存储管理的功能**	
–**C程序实例分析(MIPS)**	

![1560007306323](assets/1560007306323.png)

##### 分配和回收

![1560007658383](assets/1560007658383.png)

##### 扩充容量

![1560007688929](assets/1560007688929.png)

![1560010188260](assets/1560010188260.png)

###### 覆盖

![1560010227022](assets/1560010227022.png)![1560010249574](assets/1560010249574.png)

###### 交换

![1560010270058](assets/1560010270058.png)

![1560010295697](assets/1560010295697.png)

![1560010388681](assets/1560010388681.png)

![1560010410866](assets/1560010410866.png)

##### 共享

![1560007714163](assets/1560007714163.png)

##### 保护

![1560007759511](assets/1560007759511.png)

##### 闲置空间管理

![1560007964605](assets/1560007964605.png)

![1560007976609](assets/1560007976609.png)

![1560007996309](assets/1560007996309.png)

![1560008014856](assets/1560008014856.png)

![1560008359445](assets/1560008359445.png)

![1560008370105](assets/1560008370105.png)

#### • **存储器分配方法**	

![1560008498504](assets/1560008498504.png)

–**单一连续**	

![1560008533323](assets/1560008533323.png)–**分区管理**：**固定分区**、**可变分区**	

![1560008556608](assets/1560008556608.png)

![1560008565779](assets/1560008565779.png)

![1560008582141](assets/1560008582141.png)

![1560008609880](assets/1560008609880.png)

![1560008626470](assets/1560008626470.png)

![1560008644496](assets/1560008644496.png)

![1560008665792](assets/1560008665792.png)



**可变分区的保护-界限寄存器保护**

**可变分区的保护-只访问自己的区域**	

![1560010076041](assets/1560010076041.png)

![1560010094725](assets/1560010094725.png)

![1560010106870](assets/1560010106870.png)

### 内存管理的不同空间

![1560011802201](assets/1560011802201.png)

![1560011790402](assets/1560011790402.png)

![1560011843539](assets/1560011843539.png)

![1560011892945](assets/1560011892945.png)

![1560011942496](assets/1560011942496.png)

![1560011957755](assets/1560011957755.png)

![1560012034991](assets/1560012034991.png)

### 页式内存管理

#### 程序、进程和作业

![1560012195558](assets/1560012195558.png)

![1560012210848](assets/1560012210848.png)

![1560012248591](assets/1560012248591.png)![1560012280910](assets/1560012280910.png)

#### 分页式存储管理的基本思想

![1560012329273](assets/1560012329273.png)

#### 纯分页系统

![1560012382008](assets/1560012382008.png)

#### 基本概念

![1560012434220](assets/1560012434220.png)

![1560012676339](assets/1560012676339.png)

![1560012691811](assets/1560012691811.png)

![1560012979127](assets/1560012979127.png)

#### 页面置换算法

LRU、FIFO、Clock、OPT

### 段式内存管理

### 虚拟存储管理

### 自映射

![1560082682788](assets/1560082682788.png)

### 存储管理实例

# 进程管理

## 并发与并行

![1560014849861](assets/1560014849861.png)

### **程序的顺序执行与特征**	

![1560014870702](assets/1560014870702.png)

![1560014930205](assets/1560014930205.png)

#### 不可再现

![1560015223744](assets/1560015223744.png)

![1560015242087](assets/1560015242087.png)

![1560015256394](assets/1560015256394.png)

![1560015271265](assets/1560015271265.png)

![1560015290197](assets/1560015290197.png)

#### 进程的状态

![1560015408058](assets/1560015408058.png)

![1560015418833](assets/1560015418833.png)

![1560015490207](assets/1560015490207.png)

![1560015819911](assets/1560015819911.png)

![1560015848792](assets/1560015848792.png)

## 线程



![1560015896769](assets/1560015896769.png)

### 引入线程的目的	

![1560016517568](assets/1560016517568.png)

![1560016538383](assets/1560016538383.png)

### 用户级线程

![1560016721510](assets/1560016721510.png)![1560016752002](assets/1560016752002.png)

![1560016783946](assets/1560016783946.png)

### 内核级线程

![1560016792326](assets/1560016792326.png)

![1560016838492](assets/1560016838492.png)

![1560016854102](assets/1560016854102.png)

![1560016900855](assets/1560016900855.png)

![1560017034414](assets/1560017034414.png)

![1560017046447](assets/1560017046447.png)

![1560017055894](assets/1560017055894.png)

![1560017069814](assets/1560017069814.png)

![1560017088892](assets/1560017088892.png)

![1560017103714](assets/1560017103714.png)

![1560017172467](assets/1560017172467.png)

## 进程同步

### ▪ **同步与互斥问题**

#### 进程同步

▪ **间接相互制约。主要原因是资源共享。**
▪ **直接相互制约。主要源于进程合作。**
▪ **进程同步：指多个相关进程在执行次序上的协调，用于**
**保证这种关系的相应机制称为同步机制**。

#### 竞争状态

![1560054370905](assets/1560054370905.png)

#### 临界区

![1560054390725](assets/1560054390725.png)

![1560054436492](assets/1560054436492.png)

![1560054456451](assets/1560054456451.png)

#### 同步机制准则

![1560054505834](assets/1560054505834.png)

### ▪ **基于忙等待的互斥方法**

#### 屏蔽中断

![1560064253314](assets/1560064253314.png)

![1560064343369](assets/1560064343369.png)

#### 共享锁变量

![1560064419297](assets/1560064419297.png)

#### 严格轮换法

![1560064477446](assets/1560064477446.png)

#### Peterson算法

![1560064601708](assets/1560064601708.png)

#### 硬件指令机制

![1560064651807](assets/1560064651807.png)

![1560064677019](assets/1560064677019.png)

![1560064507291](assets/1560064507291.png)

#### 优先级反转

![1560064711140](assets/1560064711140.png)

![1560064858999](assets/1560064858999.png)



### ▪ **基于信号量的方法**

#### 信号量机制

![1560065218175](assets/1560065218175.png)

#### 信号量使用

![1560065246510](assets/1560065246510.png)

##### 信号量互斥

![1560065519357](assets/1560065519357.png)

##### 信号量同步

![1560065529249](assets/1560065529249.png)

##### 信号量会和

![1560065591449](assets/1560065591449.png)

##### 信号量多路复用

![1560065658941](assets/1560065658941.png)

![1560065745162](assets/1560065745162.png)

##### 信号量屏蔽Barriers

![1560065803228](assets/1560065803228.png)

![1560065930118](assets/1560065930118.png)

#### 解答方法

![1560065969768](assets/1560065969768.png)

#### 信号量集

![1560066021304](assets/1560066021304.png)

#### PV操作优缺点

![1560066047263](assets/1560066047263.png)

#### 互斥量

![1560066084835](assets/1560066084835.png)

#### 条件变量

![1560066135519](assets/1560066135519.png)

![1560066142853](assets/1560066142853.png)

### ▪ **基于管程的同步与互斥**


#### 概念

![1560066218998](assets/1560066218998.png)

#### 组成

![1560066249459](assets/1560066249459.png)

#### 实现

![1560066275414](assets/1560066275414.png)

### ▪ **进程通信的主要方法**

#### 进程间通信

![1560066315286](assets/1560066315286.png)

#### IPC

![1560066360443](assets/1560066360443.png)

##### 无名管道

![1560066468378](assets/1560066468378.png)

##### 有名管道

![1560066486628](assets/1560066486628.png)

##### 消息传递

![1560066508048](assets/1560066508048.png)

##### 共享内存

![1560066537627](assets/1560066537627.png)

### ▪ **经典的进程同步与互斥问题**（待学习）

#### ▪ **生产者－消费者问题**

![1560090861647](assets/1560090861647.png)

#### ▪ **读者－写者问题**

![1560090848574](assets/1560090848574.png)

![1560090918709](assets/1560090918709.png)

![1560090894526](assets/1560090894526.png)

![1560091721774](assets/1560091721774.png)

##### 闸机

非饥饿版本的读者-写者

![1560091984733](assets/1560091984733.png)

#### ▪ **理发师算法**

![1560092213543](assets/1560092213543.png)

#### 其余

![1560093002915](assets/1560093002915.png)

#### ▪ **哲学家进餐问题**

# 进程调度

## 分类一

![1560088735455](assets/1560088735455.png)

## 分类二

![1560088759561](assets/1560088759561.png)

![1560088778125](assets/1560088778125.png)

## 度量指标

![1560088846684](assets/1560088846684.png)

![1560088890583](assets/1560088890583.png)

![1560088902330](assets/1560088902330.png)

![1560088919274](assets/1560088919274.png)

![1560088930595](assets/1560088930595.png)

## 批处理调度算法

![1560088966488](assets/1560088966488.png)

![1560089130873](assets/1560089130873.png)

![1560089147911](assets/1560089147911.png)

RP即带权周转时间

## 交互式调度算法

![1560089084123](assets/1560089084123.png)

## 实时调度算法

![1560089687101](assets/1560089687101.png)

## 多处理机调度

**自调度，成组调度，专用处理机调度**

## 非对称式多处理系统

## 对称式多处理系统



# 死锁

## 定义

![1560081924726](assets/1560081924726.png)

## **竞争资源引起死锁**	

![1560081986406](assets/1560081986406.png)

## **使用信号量实现会和**引起死锁

## 发生必要条件

![1560082070397](assets/1560082070397.png)

##  处理方法

### • **鸵鸟算法**	

**无所作为，无视死锁。**	

### • **死锁检测**	

**允许死锁发生，当检测死锁发生后，采取措施恢复。**

**死锁检测算法**

### • **死锁预防**	

**破坏死锁的产生的四个条件之一。**	 

• **互斥、占有等待、不可抢占、环路等待**	 

### • **死锁避免**	

**在资源分配之前判断是否安全，仅当安全才进行分配。**

##### 银行家算法

![1560087122492](../../../%E5%8F%B6%E5%BF%97%E7%BF%94/Desktop/OS%E5%B0%8F%E7%BB%93/assets/1560087122492.png)

#### 区别	

![1560082350244](assets/1560082350244.png)



 

# IO

## **设备管理概述** 
![1560066817671](assets/1560066817671.png)

![1560066920373](assets/1560066920373.png)

![1560066932587](assets/1560066932587.png)

![1560066958444](assets/1560066958444.png)	

## **I/O硬件基础**	

### 控制器

![1560066982252](assets/1560066982252.png)

![1560066994949](assets/1560066994949.png)

![1560067015840](assets/1560067015840.png)

## **I/O软件原理**	

### 目标

![1560067037452](assets/1560067037452.png)

![1560067049863](assets/1560067049863.png)

![1560067080201](assets/1560067080201.png)

![1560067089664](assets/1560067089664.png)

### IO控制技术

![1560067098942](assets/1560067098942.png)

#### PIO

![1560067154599](assets/1560067154599.png)

![1560067162966](assets/1560067162966.png)

#### DMA

![1560067173577](assets/1560067173577.png)

![1560067188408](assets/1560067188408.png)

![1560067305085](assets/1560067305085.png)

#### Channel

![1560067399515](assets/1560067399515.png)![1560067407896](assets/1560067407896.png)

## **I/O软件概述**	

### IO软件层次结构

![1560067434222](assets/1560067434222.png)

### 中断

![1560067461504](assets/1560067461504.png)

![1560067481530](assets/1560067481530.png)

### 设备驱动程序

![1560067551256](assets/1560067551256.png)

![1560067568693](assets/1560067568693.png)

![1560067579275](assets/1560067579275.png)

![1560067603065](assets/1560067603065.png)

![1560067611640](assets/1560067611640.png)

### 与设备无关的软件

![1560067627086](assets/1560067627086.png)

#### 驱动程序的统一接口

#### 缓冲技术

![1560080546297](assets/1560080546297.png)

![1560080569715](assets/1560080569715.png)

##### 单缓冲

![1560080673467](assets/1560080673467.png)

##### 双缓冲

![1560080661380](assets/1560080661380.png)

##### 环形缓冲

![1560080651468](assets/1560080651468.png)

##### 缓冲池

![1560080705754](assets/1560080705754.png)

#### 错误报告

#### 设备分配

### 用户空间的IO软件

![1560067721445](assets/1560067721445.png)

#### 假脱机技术

![1560067736255](assets/1560067736255.png)

![1560080102303](assets/1560080102303.png)

![1560067746384](assets/1560067746384.png)

### 练习题

![1560067793632](assets/1560067793632.png)

## **设备管理实例**

## 电源管理

## 流机制

​	

# 磁盘管理

## **磁盘的工作原理**	

### 基本概念

![1560068100140](assets/1560068100140.png)

### 磁盘缺陷

![1560068218226](assets/1560068218226.png)

![1560068323719](assets/1560068323719.png)

![1560068360966](assets/1560068360966.png)

![1560068400628](assets/1560068400628.png)

![1560068436243](assets/1560068436243.png)

## **磁盘的组织与操作系统启动**

### **主引导扇区(MBR)**	

![1560068490526](assets/1560068490526.png)



### **分区表(DPT)**	

![1560068541083](assets/1560068541083.png)

![1560068582306](assets/1560068582306.png)

### **分区引导扇区(DBR)** 	

![1560068564385](assets/1560068564385.png)

![1560068607513](assets/1560068607513.png)

## 磁盘的类型

![1560068651294](assets/1560068651294.png)

## 磁盘访问时间

### 寻道时间

![1560068691318](assets/1560068691318.png)

### 旋转延迟时间

![1560068742506](assets/1560068742506.png)

### 传输时间

![1560068715943](assets/1560068715943.png)

### 总时间

![1560068763807](assets/1560068763807.png)

![1560068796791](assets/1560068796791.png)

## 磁盘调度算法

![1560068825017](assets/1560068825017.png)

![1560069036078](assets/1560069036078.png)

![1560069090016](assets/1560069090016.png)

### 练习题

![1560069051360](assets/1560069051360.png)

## **磁盘储存空间的管理**	

### **空闲表法**	

将外存空间上一个连续未分配区域称为“空闲区”。 

每个表项对应一个空闲区，它适用于连续文件结构。

### **空闲链表法**	

![1560069164021](assets/1560069164021.png)

### **位视图**	

每一位仅对应文件存储器上的一个物理块， 

取值0和1分别表示空闲和占用。

### **成组链接法**	

将空闲块分成若干组，每100个空闲块为一组… ， 

每组的第一个空闲块登记了下一组空闲块的物理盘块号和空闲块总数。 

如果一组的第一个空闲块号等于0，意味着该组是最后一组

## **保证磁盘的可靠性**	
### RAID-1

• **镜像磁盘冗余阵列，将每一数据块重复存入镜像磁盘，** 

**以改善磁盘机的可靠性。镜像盘也称拷贝盘，使有效容** 

**量下降了一半，成本较高。**	 

• **一个写操作，每个strip写两次。**	 

• **读操作可以使用任意副本，性能翻倍**	

### RAID-2

• **以字为单位**• **采用海明码纠错冗余的磁盘阵列，将数据位交叉**
**写入几个磁盘中。**	
• **1，2，4位作为奇偶校验位，其他4位做数据位**	
• **7个磁盘同步旋转，7位汉明码同时写入7个驱动器**	

![1560069585856](assets/1560069585856.png)

### RAID-3

• **采用奇偶校验冗余的磁盘阵列，也采用数据位交叉，阵**
**列中只有一个校验盘。**	

![1560069600583](assets/1560069600583.png)

![1560069627326](assets/1560069627326.png)

### RAID-4

• **一种独立传送磁盘阵列，采用数据块交叉，用一个校**
**验盘。将数据按块交叉存储在多个磁盘上。**	

![1560069644357](assets/1560069644357.png)

### RAID-5

• **一种独立传送磁盘阵列，采用数据块交叉和分布的冗余**
**校验，将数据和校验都分布在各个磁盘中，没有专门的**
**奇偶校验驱动器。**	
• **从而避免将奇偶校验磁盘变成瓶颈**	
• **磁盘失效后重建内容开销大**	

### RAID-6

§ **双维校验独立存取盘阵列，数据以块（块大小可变**
**）交叉方式存于各盘，检、纠错信息均匀分布在所**
**有磁盘上。** 	
§ **相比RAID5提高更好的可靠性**	

![1560069675010](assets/1560069675010.png)

### 小结

![1560069735918](assets/1560069735918.png)

## **提高I/O速度**	

### 主要途径

![1560069773329](assets/1560069773329.png)

### 缓存

![1560069793533](assets/1560069793533.png)

### 优化数据布局

![1560069814257](assets/1560069814257.png)
### 其他方法

![1560069835360](assets/1560069835360.png)

## **磁盘管理实例**	

### Window2000

# 文件系统

## **文件系统基本概念**	

### 数据的持久化存储

![1560070642438](assets/1560070642438.png)

![1560070702158](assets/1560070702158.png)

### 文件的概念

![1560070732026](assets/1560070732026.png)

![1560070867059](assets/1560070867059.png)

![1560070880294](assets/1560070880294.png)

### 文件管理

### 文件系统

#### 文件系统模型的三个层次

#### 文件类型

普通文件、目录文件、特殊文件

### 文件的逻辑结构

### **典型的文件结构...**

![1560071446672](assets/1560071446672.png)

### 文件控制块与文件属性

![1560071551439](assets/1560071551439.png)

### 目录

#### 目录内容

![1560071591507](assets/1560071591507.png)![1560071611805](assets/1560071611805.png)

#### 单级文件目录

![1560071730493](assets/1560071730493.png)

#### 两级文件目录

![1560071755388](assets/1560071755388.png)

#### 多级文件目录

![1560071776122](assets/1560071776122.png)

![1560071797661](assets/1560071797661.png)

## **文件系统实现方法**	

### 磁盘上文件系统的布局

![1560071847769](assets/1560071847769.png)

### 文件控制块

![1560071902438](assets/1560071902438.png)

### 文件结构

![1560071942349](assets/1560071942349.png)

#### 连续文件

.....

#### 串联文件结构/链接文件结构

![1560072048342](assets/1560072048342.png)

![1560072105380](assets/1560072105380.png)

#### 练习题

![1560072516381](assets/1560072516381.png)

#### 使用内存表的串联文件结构

![1560072658461](assets/1560072658461.png)

#### 索引文件结构（i结点）

![1560072630843](assets/1560072630843.png)

![1560073089383](assets/1560073089383.png)

![1560073349980](assets/1560073349980.png)

![1560073478431](assets/1560073478431.png)

### 目录的实现

![1560073583356](assets/1560073583356.png)

### 保护文件的方法

**建立副本**	
**定时转储**	
**规定文件的权限**	

### 安全性的设计原则

![1560078946650](assets/1560078946650.png)

### 文件的并发访问

### 文件系统的性能问题

![1560079026647](assets/1560079026647.png)

#### 块高速缓存

![1560079079010](assets/1560079079010.png)

![1560079108838](assets/1560079108838.png)

![1560079119663](assets/1560079119663.png)

### 练习题

![1560079177521](assets/1560079177521.png)

## **文件系统实例分析**	

